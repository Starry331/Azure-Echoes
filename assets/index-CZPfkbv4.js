import{r as y,a as se,c as ie,m as b,A as S,R as oe}from"./vendor-DJlmxMTT.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const h of r.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}})();var X={exports:{}},A={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var le=y,he=Symbol.for("react.element"),xe=Symbol.for("react.fragment"),de=Object.prototype.hasOwnProperty,ue=le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pe={key:!0,ref:!0,__self:!0,__source:!0};function K(t,s,a){var c,n={},r=null,h=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(h=s.ref);for(c in s)de.call(s,c)&&!pe.hasOwnProperty(c)&&(n[c]=s[c]);if(t&&t.defaultProps)for(c in s=t.defaultProps,s)n[c]===void 0&&(n[c]=s[c]);return{$$typeof:he,type:t,key:r,ref:h,props:n,_owner:ue.current}}A.Fragment=xe;A.jsx=K;A.jsxs=K;X.exports=A;var e=X.exports,H={},B=se;H.createRoot=B.createRoot,H.hydrateRoot=B.hydrateRoot;const me={};function ge(t,s){let a;try{a=t()}catch{return}return{getItem:n=>{var r;const h=i=>i===null?null:JSON.parse(i,void 0),u=(r=a.getItem(n))!=null?r:null;return u instanceof Promise?u.then(h):h(u)},setItem:(n,r)=>a.setItem(n,JSON.stringify(r,void 0)),removeItem:n=>a.removeItem(n)}}const E=t=>s=>{try{const a=t(s);return a instanceof Promise?a:{then(c){return E(c)(a)},catch(c){return this}}}catch(a){return{then(c){return this},catch(c){return E(c)(a)}}}},fe=(t,s)=>(a,c,n)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:g=>g,version:0,merge:(g,f)=>({...f,...g}),...s},h=!1;const u=new Set,i=new Set;let o;try{o=r.getStorage()}catch{}if(!o)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...g)},c,n);const w=E(r.serialize),l=()=>{const g=r.partialize({...c()});let f;const p=w({state:g,version:r.version}).then(k=>o.setItem(r.name,k)).catch(k=>{f=k});if(f)throw f;return p},d=n.setState;n.setState=(g,f)=>{d(g,f),l()};const x=t((...g)=>{a(...g),l()},c,n);let v;const m=()=>{var g;if(!o)return;h=!1,u.forEach(p=>p(c()));const f=((g=r.onRehydrateStorage)==null?void 0:g.call(r,c()))||void 0;return E(o.getItem.bind(o))(r.name).then(p=>{if(p)return r.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==r.version){if(r.migrate)return r.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var k;return v=r.merge(p,(k=c())!=null?k:x),a(v,!0),l()}).then(()=>{f==null||f(v,void 0),h=!0,i.forEach(p=>p(v))}).catch(p=>{f==null||f(void 0,p)})};return n.persist={setOptions:g=>{r={...r,...g},g.getStorage&&(o=g.getStorage())},clearStorage:()=>{o==null||o.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>m(),hasHydrated:()=>h,onHydrate:g=>(u.add(g),()=>{u.delete(g)}),onFinishHydration:g=>(i.add(g),()=>{i.delete(g)})},m(),v||x},be=(t,s)=>(a,c,n)=>{let r={storage:ge(()=>localStorage),partialize:m=>m,version:0,merge:(m,g)=>({...g,...m}),...s},h=!1;const u=new Set,i=new Set;let o=r.storage;if(!o)return t((...m)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),a(...m)},c,n);const w=()=>{const m=r.partialize({...c()});return o.setItem(r.name,{state:m,version:r.version})},l=n.setState;n.setState=(m,g)=>{l(m,g),w()};const d=t((...m)=>{a(...m),w()},c,n);n.getInitialState=()=>d;let x;const v=()=>{var m,g;if(!o)return;h=!1,u.forEach(p=>{var k;return p((k=c())!=null?k:d)});const f=((g=r.onRehydrateStorage)==null?void 0:g.call(r,(m=c())!=null?m:d))||void 0;return E(o.getItem.bind(o))(r.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==r.version){if(r.migrate)return[!0,r.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var k;const[D,P]=p;if(x=r.merge(P,(k=c())!=null?k:d),a(x,!0),D)return w()}).then(()=>{f==null||f(x,void 0),x=c(),h=!0,i.forEach(p=>p(x))}).catch(p=>{f==null||f(void 0,p)})};return n.persist={setOptions:m=>{r={...r,...m},m.storage&&(o=m.storage)},clearStorage:()=>{o==null||o.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>v(),hasHydrated:()=>h,onHydrate:m=>(u.add(m),()=>{u.delete(m)}),onFinishHydration:m=>(i.add(m),()=>{i.delete(m)})},r.skipHydration||v(),x||d},ye=(t,s)=>"getStorage"in s||"serialize"in s||"deserialize"in s?((me?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),fe(t,s)):be(t,s),we=ye,N={title:"蔚蓝回响",subtitle:"Azure Echo",characters:{protagonist:{name:"我",color:"#6bb3ff"},heroine:{name:"神秘少女",color:"#7dd3fc"},xiyin:{name:"汐音",color:"#7dd3fc"},neighbor:{name:"山田大婶",color:"#f9a8d4"}},scenes:{start:{background:"./assets/backgrounds/beach_noon.png",bgm:"./assets/bgm/cicada.mp3",dialogs:[{character:null,text:"【序章：潮汐的赠礼】",effect:"fade"},{character:null,text:"热。"},{character:null,text:"空气粘稠得像是融化的胶水，每一次呼吸都伴随着灼烧感。"},{character:null,text:"逃离了东京那个巨大的水泥蒸笼，我本以为老家的海边能给我带来一丝清凉。"},{character:null,text:"结果，迎接我的只是更加肆无忌惮的太阳。"},{character:null,text:"我眯着眼睛，看着前方被热浪扭曲的海岸线。"},{character:null,text:"沙滩上除了我，没有半个人影。"},{character:null,text:"只有几只海鸥不知疲倦地在低空盘旋。"},{character:"protagonist",text:"嗯……？那是什么？"},{character:null,text:"在海浪与沙滩的交界处，有一抹刺眼的白色。"},{character:null,text:"是被冲上岸的垃圾吗？还是……"},{character:null,text:"我加快了脚步，鞋子陷进滚烫的沙子里，发出沉闷的声响。"},{character:null,text:"走近后，心脏猛地收缩了一下。"},{character:null,text:"那不是垃圾。"},{character:null,text:"那是一个人。"},{character:null,text:"一个穿着白色连衣裙的少女，侧卧在浅滩上，半个身子浸泡在海水里。"},{character:"protagonist",text:"喂！你没事吧？！"},{character:null,text:"我冲过去跪在她身边，顾不上被海水打湿的裤腿。"},{character:null,text:"她的皮肤在阳光下白得近乎透明，湿透的银蓝色长发如同海藻般散落在沙滩上。"},{character:null,text:"我颤抖着伸出手，触碰到她肩膀的瞬间，一股刺骨的寒意顺着指尖传来。"},{character:null,text:"简直就像是触碰到了一块深海的坚冰。"},{character:"protagonist",text:"好冰……喂！醒醒！能听到我说话吗？"},{character:null,text:"我焦急地拍了拍她的脸颊。"},{character:null,text:"几秒钟后，她的睫毛微微颤动了一下，缓缓睁开了眼睛。"},{character:null,text:"那是一双深邃得仿佛能吸入灵魂的蔚蓝色瞳孔，里面没有倒映出我的脸，只有一片虚无。"},{character:"heroine",text:"……好吵。",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:null,text:"她的声音空灵且冷漠，不带一丝情感波动，仿佛这个世界的嘈杂与她无关。"},{character:"protagonist",text:"你……你还好吗？需要叫救护车吗？"},{character:"heroine",text:"海的……声音……消失了……",sprite:"./assets/characters/heroine/normal.png"},{character:null,text:"还没等我理解她这句莫名其妙的话，她眼中的光芒再次涣散。"},{character:null,text:"头一歪，她再次失去了意识，软软地倒在了我的怀里。"},{character:null,text:"只剩下冰冷的触感，和依旧嘈杂的蝉鸣。"},{character:null,text:"【序章 END】",effect:"fade"}],nextScene:"chapter1"},chapter1:{background:"./assets/backgrounds/old_room_sunset.png",bgm:"./assets/bgm/fan_waves.mp3",dialogs:[{character:null,text:"【第一章：陆地上的第一口空气】",effect:"fade"},{character:null,text:"我坐在床边的木椅上，看着躺在床上的少女。"},{character:null,text:"电风扇费力地摇着头，吹出微弱的热风。"},{character:null,text:"把她从海滩一路抱回来废了我不少力气，好在她的体重轻得不可思议。"},{character:null,text:"我已经给她盖上了薄毯子，但她身上的体温依然低得吓人。"},{character:"protagonist",text:"（叹气）这下可真是捡了个大麻烦回来啊……"},{character:null,text:"床上的少女动了一下。"},{character:null,text:"她缓缓撑起上半身，盖在身上的毯子滑落。"},{character:null,text:"她环顾着这个陌生的旧房间，眼神中充满了像被捕获的小动物一样的警惕。"},{character:null,text:"最终，她的目光锁定在了我的身上，身体不由自主地向后缩了缩，双手抓紧了被角。"},{character:"heroine",text:"这里是……哪里？你……是谁？",sprite:"./assets/characters/heroine/scared.png",position:"center"},{character:"protagonist",text:"别紧张，这里是我家。我是个趁暑假回来的大学生。"},{character:"protagonist",text:"你在海边晕倒了，我把你带了回来。不然你大概会被晒成人干。"},{character:null,text:"她听完我的话，稍微放松了一些警惕，抓着被角的手松开了一些。"},{character:"heroine",text:"是你……救了我？",sprite:"./assets/characters/heroine/normal.png"},{character:"protagonist",text:"算是吧。话说回来，你叫什么名字？家住在哪里？需要我帮你联系家人吗？"},{character:null,text:"听到我的问题，她愣住了。"},{character:null,text:"她低下头，眉头微微皱起，似乎在努力思索着什么。"},{character:null,text:"过了好一会儿，她摇了摇头，声音变得低落起来，眼神里充满了迷茫。"},{character:"heroine",text:"我……想不起来了。",sprite:"./assets/characters/heroine/sad.png"},{character:"heroine",text:"名字……过去……什么都……脑子里只有一片蓝色……",sprite:"./assets/characters/heroine/sad.png"},{character:null,text:"失忆？真是教科书般的展开啊。"},{character:null,text:"看着她那双因为迷茫而显得脆弱的眼睛，我实在无法怀疑她在撒谎。"},{character:null,text:"总不能一直叫她『喂』或者『那个谁』，既然如此……"},{character:"protagonist",text:"既然想不起来，那就先取个暂时的名字吧？"},{character:"protagonist",text:"我看你的头发颜色很像大海，又是顺着潮汐被冲上来的……"},{character:"protagonist",text:"不如就叫你 汐音 吧。潮汐的汐，声音的音。"},{character:null,text:"她抬起头，低声重复着这个名字。"},{character:"xiyin",text:"汐……音……",sprite:"./assets/characters/heroine/normal.png"},{character:null,text:"她似乎在品味这两个字的发音。"},{character:null,text:"随后，她的嘴角微微上扬，露出了一个极淡的、如释重负般的微笑。"},{character:null,text:"那个瞬间，昏暗的房间仿佛都被照亮了一瞬。"},{character:"xiyin",text:"汐音……是个好听的名字。我喜欢。",sprite:"./assets/characters/heroine/happy.png"},{character:null,text:"【音效：咕——】"},{character:null,text:"温馨的气氛瞬间被打破了。"},{character:null,text:"声音清晰地从她肚子里传了出来。"},{character:null,text:"汐音愣住了，她瞪大了眼睛，双手慌乱地按住自己的肚子，一脸不可思议地看着我。"},{character:"xiyin",text:"刚才……身体里……发出了奇怪的雷鸣？",sprite:"./assets/characters/heroine/surprised.png"},{character:"protagonist",text:"（忍不住笑出声）那不是雷鸣，那是你肚子饿了在抗议。"},{character:"protagonist",text:"看来在找回记忆之前，我得先负责把你喂饱了。走吧，我去弄点吃的。"},{character:null,text:"【第一章 END】",effect:"fade"}],nextScene:"chapter2"},chapter2:{background:"./assets/backgrounds/living_room_night.png",bgm:"./assets/bgm/night_static.mp3",dialogs:[{character:null,text:"【第二章：危险的温度】",effect:"fade"},{character:null,text:"把汐音安顿在沙发上后，我翻遍了橱柜，只找到了两盒速食杯面。"},{character:null,text:"随着开水注入，人工调味料浓烈的香气在狭窄的空间里弥漫开来。"},{character:"protagonist",text:"条件有限，今晚先凑合一下。这叫杯面，等三分钟就能吃了。"},{character:null,text:"汐音蜷缩在沙发角落，死死盯着那两个冒着白气的纸杯。"},{character:"xiyin",text:"那个白色的烟雾……是它的灵魂吗？",sprite:"./assets/characters/heroine/surprised.png",position:"center"},{character:"protagonist",text:"不，那是热气。说明它很烫，很危险。"},{character:null,text:"三分钟到。我揭开盖子，递给她一杯。"},{character:null,text:"她犹豫地接过，模仿我的动作拿起叉子，挑起一缕面条。"},{character:null,text:"还没等我提醒，她就直接送进了嘴里。"},{character:"xiyin",text:"！！！",sprite:"./assets/characters/heroine/surprised.png"},{character:null,text:"她猛地捂住嘴，身体剧烈颤抖，眼角瞬间泛起了生理性的泪花。"},{character:"xiyin",text:"好痛……舌头……被咬了……",sprite:"./assets/characters/heroine/scared.png"},{character:null,text:"看着她痛苦的样子，我必须做点什么。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"快吐出来！喝点冷水！",nextScene:"chapter2_choiceA",affection:5,alienation:0,adaptation:-2},{text:"要吹一吹再吃，像这样。",nextScene:"chapter2_choiceB",affection:3,alienation:-2,adaptation:3}]}]},chapter2_choiceA:{background:"./assets/backgrounds/living_room_night.png",bgm:"./assets/bgm/night_static.mp3",dialogs:[{character:"protagonist",text:"快吐出来！别咽下去！"},{character:"protagonist",text:"那是开水泡的，会烫伤食道的！"},{character:null,text:"我慌忙倒了一杯凉水递到她嘴边。"},{character:null,text:"汐音听话地吐掉了面条，大口喝着凉水，胸口剧烈起伏。"},{character:null,text:"过了好一会儿，她才缓过劲来，眼泪汪汪地看着我。"},{character:"xiyin",text:"陆地上的食物……好可怕……",sprite:"./assets/characters/heroine/sad.png",position:"center"},{character:"xiyin",text:"如果没有你在……我刚才可能就被它杀死了。",sprite:"./assets/characters/heroine/normal.png"},{character:"protagonist",text:"没那么夸张……不过以后吃东西前一定要问我。"},{character:"xiyin",text:"嗯……我会听话的。只要听你的话，就不会痛了对吧？",sprite:"./assets/characters/heroine/happy.png"},{character:null,text:"她抓住了我的袖口，眼神中充满了依赖。"},{character:null,text:"但这似乎并不是什么好事，她变得更加畏惧这个世界了。"},{character:null,text:"【第二章 END】",effect:"fade"}],nextScene:"chapter3"},chapter2_choiceB:{background:"./assets/backgrounds/living_room_night.png",bgm:"./assets/bgm/night_static.mp3",dialogs:[{character:"protagonist",text:"别急着吞下去。人类的食物大都是热的，你要学会让它降温。"},{character:"protagonist",text:"看我的口型，轻轻吹气——呼——"},{character:null,text:"汐音含着眼泪，看着我示范的动作。"},{character:null,text:"她试探性地嘟起嘴唇，对着叉子上的面条轻轻吹气。"},{character:"xiyin",text:"呼……呼……是这样吗？",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:"protagonist",text:"对，再试试。"},{character:null,text:"这次她小心翼翼地吃了一口。"},{character:null,text:"虽然眉头还是皱着，但紧接着，她的表情舒展开来，眼中闪烁着新奇的光芒。"},{character:"xiyin",text:"奇怪的感觉……痛觉消失了，变成了……暖洋洋的味道。",sprite:"./assets/characters/heroine/happy.png"},{character:"xiyin",text:"陆地上的生物，原来是靠吃这种『痛觉』活着的吗？真有趣。",sprite:"./assets/characters/heroine/playful.png"},{character:null,text:"她似乎接受了这个设定，开始笨拙地模仿我吹气的动作。"},{character:null,text:"这孩子，适应力也许比我想象的要强。"},{character:null,text:"【第二章 END】",effect:"fade"}],nextScene:"chapter3"},chapter3:{background:"./assets/backgrounds/bathroom_night.png",bgm:"./assets/bgm/dripping_ambient.mp3",dialogs:[{character:null,text:"【第三章：干涸的焦虑】",effect:"fade"},{character:null,text:"深夜，我发现汐音不见了。"},{character:null,text:"最后，我在浴室里发现了她。"},{character:null,text:"她穿着我不合身的衬衫，整个人蜷缩在没有放水的空浴缸里，"},{character:null,text:"像是一个被遗弃在岸边、即将干涸的贝壳。"},{character:"protagonist",text:"汐音？不回房间睡吗？浴缸里很硬吧。"},{character:null,text:"听到我的声音，她缓缓抬起头。"},{character:null,text:"借着月光，我看到她的皮肤虽然依旧白皙，但似乎失去了一些光泽，显得有些干燥粗糙。"},{character:"xiyin",text:"那个房间……空气太干了。",sprite:"./assets/characters/heroine/sad.png",position:"center"},{character:"xiyin",text:"感觉就像……肺里吸满了沙子。皮肤也……很难受。",sprite:"./assets/characters/heroine/scared.png"},{character:null,text:"离开水太久，对她来说或许不仅仅是不适，更是威胁生命的事。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"只要你在我身边我就放心了。",nextScene:"chapter3_trueRoute",affection:5,alienation:-5,adaptation:0},{text:"我帮你放点温水，今晚就睡在水里吧。",nextScene:"chapter3_deathRoute",affection:3,alienation:5,adaptation:-2},{text:"必须忍耐，想在陆地生活就得适应干燥。",nextScene:"chapter3_badRoute",affection:-3,alienation:-10,adaptation:5}]}]},chapter3_deathRoute:{background:"./assets/backgrounds/bathroom_night.png",bgm:"./assets/bgm/dripping_ambient.mp3",dialogs:[{character:"protagonist",text:"别怕，只是还不习惯而已。"},{character:"protagonist",text:"我会一直陪着你的，直到你睡着。"},{character:null,text:"我伸手握住了她冰凉的手。"},{character:null,text:"汐音看着我，眼中的恐惧稍微消退了一些。"},{character:"xiyin",text:"真的吗？……你在身边的话，那种刺痛感好像稍微好一点了。",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:"xiyin",text:"那我……就忍耐一下吧。虽然这里很难受，但我不想离开你。",sprite:"./assets/characters/heroine/sad.png"},{character:null,text:"她强撑着露出一个虚弱的笑容，闭上了眼睛。"},{character:null,text:"我并不知道，我的这句安慰，正在让她透支生命来对抗本能。"},{character:null,text:"【第三章 END - 死亡路线开启】",effect:"fade"}],nextScene:"chapter4"},chapter3_trueRoute:{background:"./assets/backgrounds/bathroom_night.png",bgm:"./assets/bgm/dripping_ambient.mp3",dialogs:[{character:"protagonist",text:"抱歉，是我考虑不周。"},{character:"protagonist",text:"既然很难受，那就不要勉强了。我给你放水。"},{character:null,text:"我拧开水龙头。水流哗啦啦地涌出。"},{character:null,text:"随着水位慢慢上涨，没过她的身体，汐音紧绷的肩膀终于放松了下来。"},{character:null,text:"原本干燥的皮肤在接触到水的瞬间，仿佛重新获得了生命力。"},{character:"xiyin",text:"水……啊……",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:"xiyin",text:"谢谢你……这样我就安心了……水的声音，就像摇篮曲一样。",sprite:"./assets/characters/heroine/happy.png"},{character:null,text:"她把脸颊贴在膝盖上，在水中露出了安心的笑容，"},{character:null,text:"尾椎处甚至隐约泛起了鳞片的光泽。"},{character:"xiyin",text:"晚安……你要是敢偷看的话，我会生气的哦？",sprite:"./assets/characters/heroine/playful.png"},{character:null,text:"【第三章 END - 真/好结局路线开启】",effect:"fade"}],nextScene:"chapter4"},chapter3_badRoute:{background:"./assets/backgrounds/bathroom_night.png",bgm:"./assets/bgm/dripping_ambient.mp3",dialogs:[{character:"protagonist",text:"汐音，你不能总依赖水。"},{character:"protagonist",text:"既然来到了陆地，如果不适应这种干燥，你是没法在这里活下去的。站起来，回房间去。"},{character:null,text:"我的语气严厉了一些。"},{character:null,text:"汐音愣住了，她难以置信地看着我，身体颤抖了一下。"},{character:"xiyin",text:"你是说……这种痛苦，是必须的吗？",sprite:"./assets/characters/heroine/surprised.png",position:"center"},{character:"xiyin",text:"……我知道了。因为这是你们人类的规矩，对吧？",sprite:"./assets/characters/heroine/angry.png"},{character:null,text:"她咬着嘴唇，强忍着不适站了起来，走出了浴缸。"},{character:null,text:"经过我身边时，她没有看我。"},{character:"xiyin",text:"我会适应的……就算皮肤裂开也会适应的。你满意了吗？",sprite:"./assets/characters/heroine/angry.png"},{character:null,text:"看着她倔强却孤单的背影，我感觉到我们之间产生了一道看不见的裂痕。"},{character:null,text:"【第三章 END - 坏结局路线开启】",effect:"fade"}],nextScene:"chapter4"},chapter4:{background:"./assets/backgrounds/living_room_morning.png",bgm:"./assets/bgm/morning_birds.mp3",dialogs:[{character:null,text:"【第四章：清晨的不速之客】",effect:"fade"},{character:null,text:"清晨的阳光透过窗帘缝隙刺痛了我的眼睛。"},{character:null,text:"昨晚折腾到很晚，我感觉全身酸痛。"},{character:null,text:"我迷迷糊糊地走到客厅，眼前的景象让我瞬间清醒了。"},{character:null,text:"汐音正跪坐在电视机前，脸贴得离屏幕只有五厘米。"},{character:null,text:"她身上还穿着我那件宽大的白衬衫，光着两条腿，随着电视里早操的节奏，奇怪地晃动着脑袋。"},{character:"protagonist",text:"……你在干什么？"},{character:null,text:"她吓了一跳，像受惊的猫一样猛地回过头。"},{character:"xiyin",text:"这个黑色的箱子……里面关着小人。",sprite:"./assets/characters/heroine/surprised.png",position:"center"},{character:"xiyin",text:"他们在做奇怪的动作……是在求救吗？",sprite:"./assets/characters/heroine/normal.png"},{character:"protagonist",text:"那是电视，里面的人不是真的……算了，很难解释。"},{character:null,text:"就在我准备去刷牙的时候——"},{character:null,text:"【咚咚咚！】",effect:"shake"},{character:null,text:"响亮的敲门声传来。"},{character:"neighbor",text:"在吗？我是住在隔壁的山田啊！给你送自家种的西瓜来了！",sprite:"./assets/characters/neighbor/Yamada-san.png",position:"center"},{character:null,text:"心脏骤停。"},{character:null,text:"是隔壁那个以『大嘴巴』著称的山田大婶。"},{character:null,text:"要是被她看到家里有个穿着男式衬衫、来历不明的美少女……"},{character:null,text:"不出半天，整个镇子都会传遍『某家的小儿子拐带未成年少女』的谣言。"},{character:"protagonist",text:"遭了！汐音，快躲……"},{character:null,text:"来不及了。"},{character:null,text:"玄关的大门并没有锁（乡下的坏习惯），随着『嘎吱』一声，门被拉开了。"},{character:"neighbor",text:"哎呀门没锁呢！我就直接进来了哦——诶？"},{character:null,text:"时间仿佛静止了。"},{character:null,text:"大婶手里抱着西瓜，僵在原地，目光落在了衣衫不整的汐音身上。"},{character:null,text:"汐音也愣住了，她看着陌生的大婶，本能地感到了威胁，身体微微紧绷。"},{character:"xiyin",text:"这个人类……气息很强。是敌人吗？",sprite:"./assets/characters/heroine/angry.png"},{character:null,text:"必须立刻解释！否则就完蛋了！"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"这是我远房表妹！来海边度假的！",nextScene:"chapter4_cousin",affection:1,alienation:0,adaptation:5},{text:"她是我女朋友。我们正在同居。",nextScene:"chapter4_girlfriend",affection:5,alienation:0,adaptation:3,flag:"girlfriendDeclared"},{text:"哇！别进来！快藏起来！",nextScene:"chapter4_hide",affection:-5,alienation:5,adaptation:-5}]}]},chapter4_cousin:{background:"./assets/backgrounds/living_room_morning.png",bgm:"./assets/bgm/morning_birds.mp3",dialogs:[{character:"protagonist",text:"啊哈哈……山田阿姨早啊！这是我……远房表妹！汐音！"},{character:"protagonist",text:"她刚到，还没来得及换衣服呢！哈哈……"},{character:null,text:"我一边干笑，一边不动声色地挡在汐音面前。"},{character:null,text:"大婶狐疑地打量了一下汐音那头罕见的银蓝色头发。"},{character:"neighbor",text:"表妹？长得真不像啊……这头发是染的吧？现在的年轻人真时髦。"},{character:"protagonist",text:"对对，COSPLAY嘛！现在很流行的！"},{character:"protagonist",text:"汐音，快跟阿姨打招呼。"},{character:null,text:"我给汐音使了个眼色。"},{character:null,text:"汐音虽然不懂『表妹』是什么意思，但她似乎理解了现在的状况需要『伪装』。"},{character:null,text:"她收起了敌意，笨拙地模仿电视里的人挥了挥手。"},{character:"xiyin",text:"你好……我是……表妹。",sprite:"./assets/characters/heroine/greeting.png",position:"center"},{character:"neighbor",text:"哎呀，声音真好听。行吧，那我不打扰你们年轻人了，西瓜放这儿了啊！"},{character:null,text:"大婶放下西瓜离开了。汐音松了一口气，瘫坐在地上。"},{character:"xiyin",text:"『表妹』……是某种隐身术的咒语吗？那个敌人好像相信了。",sprite:"./assets/characters/heroine/playful.png"},{character:null,text:"【第四章 END - 汐音获得虚假身份】",effect:"fade"}],nextScene:"chapter5"},chapter4_girlfriend:{background:"./assets/backgrounds/living_room_morning.png",bgm:"./assets/bgm/morning_birds.mp3",dialogs:[{character:null,text:"我深吸一口气。"},{character:"protagonist",text:"其实……阿姨，这是我女朋友。我们正在……同居。"},{character:null,text:"空气凝固了一秒，随即大婶的脸上爆发出了八卦的笑容。"},{character:null,text:"汐音听到『女朋友』这个词，歪了歪头。"},{character:"xiyin",text:"女……朋友？那是……什么？",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:null,text:"我小声对她说："},{character:"protagonist",text:"就是最重要的人的意思。"},{character:null,text:"听到『最重要的人』，汐音的眼睛瞬间亮了。"},{character:null,text:"她原本紧绷的身体彻底放松，甚至主动从我身后探出头来，脸上带着自豪的表情。"},{character:"xiyin",text:"对！我是他的……女朋友！",sprite:"./assets/characters/heroine/happy.png"},{character:"xiyin",text:"最重要的人！",sprite:"./assets/characters/heroine/happy.png"},{character:"neighbor",text:"哎哟喂！现在的大学生真是热情啊！好好好，阿姨懂的，西瓜给你们补补身子！"},{character:null,text:"大婶带着意味深长的笑容离开了。"},{character:null,text:"虽然误会加深了，但看着汐音开心的样子，我竟然觉得这样也不坏。"},{character:null,text:"【第四章 END - 确立『女友』身份】",effect:"fade"}],nextScene:"chapter5"},chapter4_hide:{background:"./assets/backgrounds/living_room_morning.png",bgm:"./assets/bgm/morning_birds.mp3",dialogs:[{character:"protagonist",text:"汐音！快躲起来！"},{character:null,text:"我不由分说，一把抓起汐音，将她塞进了旁边的壁橱里，并用力拉上了推拉门。"},{character:null,text:"动作一气呵成，就在大婶进来的前一秒。"},{character:"neighbor",text:"你在跟谁说话呢？"},{character:"protagonist",text:"没、没有！我在看电视！电视声音太大了！"},{character:null,text:"我满头大汗地应付走了大婶。"},{character:null,text:"等她一走，我赶紧拉开壁橱门。"},{character:null,text:"汐音蜷缩在黑暗狭窄的壁橱角落里，抱着膝盖，浑身发抖。"},{character:null,text:"她抬头看着我，眼神里充满了惊恐和委屈。"},{character:"xiyin",text:"好黑……好挤……",sprite:"./assets/characters/heroine/scared.png",position:"center"},{character:"xiyin",text:"我是……见不得光的东西吗？为什么要像藏垃圾一样把我藏起来？",sprite:"./assets/characters/heroine/sad.png"},{character:null,text:"看着她受伤的眼神，我心中充满了愧疚。"},{character:null,text:"我似乎做了一个最差劲的选择。"},{character:null,text:"【第四章 END - 汐音对人类社会产生恐惧】",effect:"fade"}],nextScene:"chapter5"},chapter5:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:null,text:"【第五章：鳞片下的秘密】",effect:"fade"},{character:null,text:"打发走了隔壁的山田太太后，我意识到一个严峻的问题。"},{character:null,text:"汐音现在身上还穿着我的旧衬衫，不仅不合身，而且……作为女生来说，一直『真空』确实不太方便。"},{character:null,text:"更重要的是，昨晚在月光下，我隐约看到了她背上的异样。为了确认她的身体状况，必须让她把背露出来。"},{character:null,text:"我手里拿着刚从便利店买回来的袋子，站在卧室门口。"},{character:null,text:"袋子里是牙刷、毛巾，还有……"},{character:null,text:"【消费抉择】",effect:"fade"},{choices:[{text:"拿出咬牙买下的女士内衣套装",nextScene:"chapter5_underwear",affection:2,alienation:0,adaptation:0,money:60},{text:"没钱买那个，只能用旧T恤",nextScene:"chapter5_tshirt",affection:-1,alienation:0,adaptation:0}]}]},chapter5_underwear:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"汐音，把这个换上。总穿我的衬衫也不舒服吧。"},{character:null,text:"汐音接过那两块小小的布料，脸瞬间红了。"},{character:null,text:"她钻进被窝，经过一番悉悉索索的艰难穿戴，终于慢慢掀开了被子。"},{character:"xiyin",text:"这种布料……好少。感觉像是什么都没穿一样……",sprite:"./assets/characters/heroine/underwear_shy.png",position:"center"},{character:"xiyin",text:"而且……正好贴在皮肤上。这就是陆地上的『壳』吗？",sprite:"./assets/characters/heroine/underwear_shy.png"},{character:null,text:"她跪坐在床上，双手不自在地护在胸前，脸颊绯红。"},{character:null,text:"那套简单的白色内衣穿在她身上，产生了一种纯洁与色气并存的破坏力。"}],nextScene:"chapter5_examine_underwear"},chapter5_tshirt:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:null,text:"便利店的内衣太贵了，生活费要紧。"},{character:null,text:"我从衣柜底翻出一件面料稍微薄一点的旧T恤。"},{character:"protagonist",text:"汐音，换上这个吧。之前的衬衫脏了。"},{character:null,text:"汐音乖乖换上了。领口很大，露出了锁骨，衣服松松垮垮地挂在身上。"},{character:"xiyin",text:"这件……有点磨皮肤。",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:"xiyin",text:"还是水里比较舒服……",sprite:"./assets/characters/heroine/sad.png"}],nextScene:"chapter5_examine_tshirt"},chapter5_examine_underwear:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"咳……衣服还合身吗？接下来，转过去，背对着我。"},{character:"protagonist",text:"我要检查一下你昨晚说的『刺痛』的地方。"},{character:null,text:"汐音愣了一下，虽然有些迟疑，但还是乖乖地转过身去，背对着我跪坐着。"},{character:null,text:"她银蓝色的长发滑落到胸前，露出了整个后背。"},{character:"xiyin",text:"是……这样吗？感觉后背凉飕飕的……",sprite:"./assets/characters/heroine/underwear_back.png"},{character:null,text:"我的视线落在她的脊柱两侧。"},{character:null,text:"果然。"},{character:null,text:"在她的脊柱周围，原本白皙的皮肤上，覆盖着一片片半透明的、淡蓝色的鳞片。"},{character:null,text:"它们像某种精美的刺绣一样镶嵌在她背上，但在鳞片边缘，皮肤呈现出一种缺水干裂的纹理，甚至渗着血丝。"},{character:"protagonist",text:"果然有鳞片……而且周围的皮肤开始干裂了。"},{character:null,text:"听到我的话，汐音光滑的背脊猛地颤抖了一下。"},{character:"xiyin",text:"这就是……那种痛觉的来源吗？",sprite:"./assets/characters/heroine/underwear_back.png"},{character:null,text:"她试图扭过头看自己的后背，但角度受限。她侧过脸，眼神中充满了不安和恐惧。"},{character:"xiyin",text:"我会变成……怪物吗？",sprite:"./assets/characters/heroine/underwear_scared.png"},{character:"xiyin",text:"如果变得满身都是这种东西……你还会让我留在这里吗？",sprite:"./assets/characters/heroine/underwear_scared.png"},{character:null,text:"看着她脆弱的样子，我的手指悬停在那片鳞片上方。"},{character:null,text:"现在的应对，将决定她如何看待自己的『异类』身份。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"好美……简直就像蓝宝石一样。",nextScene:"chapter5_praise_underwear",affection:5,alienation:5,adaptation:0,flag:"scalesPraised"},{text:"别动，我需要记录一下扩散范围。",nextScene:"chapter5_record_underwear",affection:-2,alienation:-2,adaptation:5},{text:"有点吓人……还是想办法把它遮住吧。",nextScene:"chapter5_hide",affection:-10,alienation:-10,adaptation:5}]}]},chapter5_examine_tshirt:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"咳……接下来，转过去，背对着我。"},{character:"protagonist",text:"我要检查一下你昨晚说的『刺痛』的地方。"},{character:null,text:"汐音愣了一下，虽然有些迟疑，但还是乖乖地转过身去。"},{character:null,text:"她撩起T恤的后摆，露出了后背。"},{character:"xiyin",text:"是……这样吗？感觉后背凉飕飕的……",sprite:"./assets/characters/heroine/back.png"},{character:null,text:"我的视线落在她的脊柱两侧。"},{character:null,text:"果然。"},{character:null,text:"在她的脊柱周围，原本白皙的皮肤上，覆盖着一片片半透明的、淡蓝色的鳞片。"},{character:null,text:"它们像某种精美的刺绣一样镶嵌在她背上，但在鳞片边缘，皮肤呈现出一种缺水干裂的纹理，甚至渗着血丝。"},{character:"protagonist",text:"果然有鳞片……而且周围的皮肤开始干裂了。"},{character:null,text:"听到我的话，汐音光滑的背脊猛地颤抖了一下。"},{character:"xiyin",text:"这就是……那种痛觉的来源吗？",sprite:"./assets/characters/heroine/back.png"},{character:null,text:"她试图扭过头看自己的后背，但角度受限。她侧过脸，眼神中充满了不安和恐惧。"},{character:"xiyin",text:"我会变成……怪物吗？",sprite:"./assets/characters/heroine/scared.png"},{character:"xiyin",text:"如果变得满身都是这种东西……你还会让我留在这里吗？",sprite:"./assets/characters/heroine/scared.png"},{character:null,text:"看着她脆弱的样子，我的手指悬停在那片鳞片上方。"},{character:null,text:"现在的应对，将决定她如何看待自己的『异类』身份。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"好美……简直就像蓝宝石一样。",nextScene:"chapter5_praise_tshirt",affection:5,alienation:5,adaptation:0,flag:"scalesPraised"},{text:"别动，我需要记录一下扩散范围。",nextScene:"chapter5_record_tshirt",affection:-2,alienation:-2,adaptation:5},{text:"有点吓人……还是想办法把它遮住吧。",nextScene:"chapter5_hide",affection:-10,alienation:-10,adaptation:5}]}]},chapter5_praise_underwear:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"不，不是怪物。很漂亮。"},{character:"protagonist",text:"你看，它在光线下会发光，就像大海的碎片一样。"},{character:null,text:"我轻轻用指腹抚摸那片微凉的鳞片，动作轻柔，像是在触碰珍宝。"},{character:null,text:"汐音愣住了。她原本紧绷的背脊慢慢软化，转过身来，惊讶地看着我。"},{character:"xiyin",text:"漂亮……？你真的……这么觉得吗？",sprite:"./assets/characters/heroine/underwear_shy.png",position:"center"},{character:"protagonist",text:"嗯。这是你独特的地方。无论你变成什么样，我都觉得很美。"},{character:null,text:"汐音的脸瞬间红透了，但这次不是因为羞耻，而是因为某种满溢出来的喜悦。"},{character:null,text:"她稍微挺起了胸膛，向我靠近了一点，眼神湿润而闪亮。"},{character:"xiyin",text:"嘿嘿……如果是那样的话……",sprite:"./assets/characters/heroine/underwear_expect.png"},{character:"xiyin",text:"再多摸摸也可以哦？你的手……热热的，很舒服。",sprite:"./assets/characters/heroine/underwear_expect.png"},{character:null,text:"【第五章 END - 汐音接受自己的非人特征】",effect:"fade"}],nextScene:"chapter6"},chapter5_praise_tshirt:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"不，不是怪物。很漂亮。"},{character:"protagonist",text:"你看，它在光线下会发光，就像大海的碎片一样。"},{character:null,text:"我轻轻用指腹抚摸那片微凉的鳞片，动作轻柔，像是在触碰珍宝。"},{character:null,text:"汐音愣住了。她原本紧绷的背脊慢慢软化，转过身来，惊讶地看着我。"},{character:"xiyin",text:"漂亮……？你真的……这么觉得吗？",sprite:"./assets/characters/heroine/shy.png",position:"center"},{character:"protagonist",text:"嗯。这是你独特的地方。无论你变成什么样，我都觉得很美。"},{character:null,text:"汐音的脸瞬间红透了，但这次不是因为羞耻，而是因为某种满溢出来的喜悦。"},{character:null,text:"她稍微挺起了胸膛，向我靠近了一点，眼神湿润而闪亮。"},{character:"xiyin",text:"嘿嘿……如果是那样的话……",sprite:"./assets/characters/heroine/happy.png"},{character:"xiyin",text:"再多摸摸也可以哦？你的手……热热的，很舒服。",sprite:"./assets/characters/heroine/happy.png"},{character:null,text:"【第五章 END - 汐音接受自己的非人特征】",effect:"fade"}],nextScene:"chapter6"},chapter5_record_underwear:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"情况不太乐观，好像比昨晚扩散了。"},{character:"protagonist",text:"别动，保持这个姿势。我拍个照记录一下，以后好对比变化。"},{character:null,text:"我拿出手机，对准她的后背。"},{character:null,text:"『咔嚓』一声快门响。"},{character:null,text:"汐音像是被鞭子抽到一样，猛地缩成一团，双手反手捂住自己的后背。"},{character:"xiyin",text:"不要！那个黑盒子……在吸走什么东西！",sprite:"./assets/characters/heroine/back.png",position:"center"},{character:"protagonist",text:"只是记录而已，为了治好你。"},{character:null,text:"汐音慢慢转过身，低着头，身体微微发抖。"},{character:null,text:"她觉得自己此刻不像是一个人，而是一条案板上的标本。"},{character:"xiyin",text:"治好……意思是，现在的我是『坏掉』的吗？",sprite:"./assets/characters/heroine/underwear_scared.png"},{character:"xiyin",text:"果然……我不该让别人看到的……",sprite:"./assets/characters/heroine/underwear_shy.png"},{character:null,text:"【第五章 END - 汐音对自己的身体产生焦虑】",effect:"fade"}],nextScene:"chapter6"},chapter5_record_tshirt:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"情况不太乐观，好像比昨晚扩散了。"},{character:"protagonist",text:"别动，保持这个姿势。我拍个照记录一下，以后好对比变化。"},{character:null,text:"我拿出手机，对准她的后背。"},{character:null,text:"『咔嚓』一声快门响。"},{character:null,text:"汐音像是被鞭子抽到一样，猛地缩成一团，双手反手捂住自己的后背。"},{character:"xiyin",text:"不要！那个黑盒子……在吸走什么东西！",sprite:"./assets/characters/heroine/back.png",position:"center"},{character:"protagonist",text:"只是记录而已，为了治好你。"},{character:null,text:"汐音慢慢转过身，低着头，身体微微发抖。"},{character:null,text:"她觉得自己此刻不像是一个人，而是一条案板上的标本。"},{character:"xiyin",text:"治好……意思是，现在的我是『坏掉』的吗？",sprite:"./assets/characters/heroine/scared.png"},{character:"xiyin",text:"果然……我不该让别人看到的……",sprite:"./assets/characters/heroine/shy.png"},{character:null,text:"【第五章 END - 汐音对自己的身体产生焦虑】",effect:"fade"}],nextScene:"chapter6"},chapter5_hide:{background:"./assets/backgrounds/bedroom_curtain.png",bgm:"./assets/bgm/heartbeat_ambient.mp3",dialogs:[{character:"protagonist",text:"这看起来……有点像严重的皮肤病。密密麻麻的，要是被别人看到就麻烦了。"},{character:"protagonist",text:"快把衣服穿上吧，别露出来了。"},{character:null,text:"我移开了视线，把衬衫丢给她。"},{character:null,text:"汐音背对着我的动作停滞了。"},{character:"xiyin",text:"……皮肤病……吓人……",sprite:"./assets/characters/heroine/back.png",position:"center"},{character:null,text:"她喃喃自语着，声音里失去了温度。"},{character:null,text:"她默默地抓起衬衫，动作机械地套在身上，将那些鳞片死死遮住，然后才转过身来。"},{character:null,text:"她看着我，眼中的光芒彻底熄灭了。"},{character:"xiyin",text:"……对不起。",sprite:"./assets/characters/heroine/sad.png"},{character:"xiyin",text:"我会藏好的。绝对……不会再恶心到你了。",sprite:"./assets/characters/heroine/sad.png"},{character:null,text:"【第五章 END - 汐音产生自我厌恶】",effect:"fade"}],nextScene:"chapter6"},chapter6:{background:"./assets/backgrounds/slope_afternoon.png",bgm:"./assets/bgm/wind_cicada.mp3",dialogs:[{character:null,text:"【第六章：便利店的微光与三厘米距离】",effect:"fade"},{character:"protagonist",text:"并不是为了约会，绝对不是。"},{character:"protagonist",text:"只是家里的牙刷和毛巾不够了，而且总让她穿着我的旧衬衫也不合适。"},{character:"protagonist",text:"这是一场必要的『物资补给行动』。"},{character:null,text:"为了避开人群，我特意选了人少的坡道。"},{character:null,text:"汐音戴着一顶宽边的遮阳帽，穿着不合身的长裙，走在我身后大约三步远的地方。"},{character:null,text:"我不敢频繁回头，生怕引人注目，但我能清晰地听到她拖沓的脚步声。"},{character:null,text:"沙沙、沙沙。"},{character:null,text:"就像海浪在追逐着海岸，始终保持着一个微妙的距离。"},{character:"xiyin",text:"……",sprite:"./assets/characters/heroine/normal.png",position:"center"},{character:null,text:"身后的脚步声突然停了。"},{character:null,text:"我回过头，发现她正蹲在一个自动贩卖机前。"},{character:null,text:"她的脸几乎贴在玻璃面板上，那一双蔚蓝色的眼睛死死盯着里面排列整齐的饮料罐。"},{character:null,text:"贩卖机发出『嗡嗡』的低频压缩机运作声，在寂静的坡道上显得格外清晰。"},{character:"xiyin",text:"这个发光的方块……在震动。",sprite:"./assets/characters/heroine/curious.png"},{character:"xiyin",text:"里面的水被封印在铁罐子里……它们是活的吗？一直在这个狭窄的牢笼里发光，等待着什么。",sprite:"./assets/characters/heroine/curious.png"},{character:"protagonist",text:"那是自动贩卖机。那些是商品，不是活的，也不会痛。"},{character:"protagonist",text:"……别贴那么近，会被路人奇怪的。"},{character:null,text:"她没有动，依旧盯着那一排排饮料。"},{character:null,text:"那种眼神，既不是想要，也不是喜欢，而是一种纯粹的、跨越物种的『无法理解』。"},{character:null,text:"在她眼里，陆地上的一切似乎都是某种残酷的牢笼。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"想喝吗？我买给你。",nextScene:"chapter6_buyDrink",affection:2,alienation:0,adaptation:-1,money:3},{text:"那不是牢笼，那是为了便利而存在的商品。",nextScene:"chapter6_explain",affection:0,alienation:1,adaptation:3},{text:"（默默站在她身边，陪她看了一会儿）",nextScene:"chapter6_accompany",affection:4,alienation:-2,adaptation:0}]}]},chapter6_buyDrink:{background:"./assets/backgrounds/slope_afternoon.png",bgm:"./assets/bgm/wind_cicada.mp3",dialogs:[{character:"protagonist",text:"（叹气）……真是的，只是想喝水了吧？想喝哪个？"},{character:null,text:"我走过去，投下硬币。随着『咣当』一声，一罐冰镇柠檬汽水滚落下来。"},{character:null,text:"我把它贴在她的脸颊上。"},{character:"xiyin",text:"呀！好凉！",sprite:"./assets/characters/heroine/surprised.png"},{character:null,text:"她像受惊的猫一样缩了一下，接过汽水。"},{character:null,text:"眼神中那份深邃的『探究』消失了，变成了单纯的快乐。"},{character:"xiyin",text:"这就是……陆地的味道吗？冰冰的，甜甜的。",sprite:"./assets/characters/heroine/happy.png"}],nextScene:"chapter6_store"},chapter6_explain:{background:"./assets/backgrounds/slope_afternoon.png",bgm:"./assets/bgm/wind_cicada.mp3",dialogs:[{character:"protagonist",text:"汐音，不要把什么都想成是有生命的。那是商品，是为了被买走而放在那里的。"},{character:"xiyin",text:"商品……等待被选中的东西……",sprite:"./assets/characters/heroine/normal.png"},{character:null,text:"她若有所思地站起来，拍了拍裙角，眼神变得有些黯淡。"},{character:"xiyin",text:"那我……也是被你选中的『商品』吗？",sprite:"./assets/characters/heroine/sad.png"},{character:"protagonist",text:"……别问这种傻问题。快走吧。"}],nextScene:"chapter6_store"},chapter6_accompany:{background:"./assets/backgrounds/slope_afternoon.png",bgm:"./assets/bgm/wind_cicada.mp3",dialogs:[{character:null,text:"我没有催促她，也没有买水。"},{character:null,text:"我看了看四周，确定没人后，也在她身边蹲了下来。"},{character:null,text:"两个人的影子在夕阳下被拉得很长，重叠在一起。"},{character:null,text:"距离拉近了，我能闻到她身上淡淡的海盐味，和周围草木的香气混合在一起。"},{character:"xiyin",text:"……如果是我的话，一定会疯掉的。",sprite:"./assets/characters/heroine/scared.png"},{character:"xiyin",text:"一直待在同一个地方，不能游动，不能说话，只能发光……",sprite:"./assets/characters/heroine/sad.png"},{character:"protagonist",text:"……也许吧。所以大家才需要买走它们。"},{character:"protagonist",text:"因为不想让它们孤独，也不想让自己孤独。"},{character:null,text:"汐音转过头。"},{character:null,text:"遮阳帽的阴影下，那双蔚蓝色的眼睛直直地看着我。"},{character:null,text:"我们的脸离得很近，近到我能看清她睫毛的颤动。"},{character:"xiyin",text:"那你呢？",sprite:"./assets/characters/heroine/curious.png"},{character:"xiyin",text:"你捡到我……也是因为不想孤独吗？",sprite:"./assets/characters/heroine/curious.png"},{character:null,text:"这个问题像一颗石子投入了我的心湖。"},{character:null,text:"我张了张嘴，却发现喉咙发干，无法回答。"},{character:null,text:"我慌乱地移开视线，站起身来掩饰般地拍了拍裤腿。"},{character:"protagonist",text:"咳……腿麻了，快走吧。"}],nextScene:"chapter6_store"},chapter6_store:{background:"./assets/backgrounds/convenience_store.png",bgm:"./assets/bgm/store_ambient.mp3",dialogs:[{character:null,text:"走进便利店，冷气扑面而来。"},{character:null,text:"汐音缩了缩脖子，下意识地向我靠近了一步，几乎贴到了我的后背。"},{character:null,text:"这种如影随形的依赖感，让我既满足又紧张。"},{character:"protagonist",text:"我们要买牙刷、毛巾，还有……"},{character:null,text:"我正看着货架，突然听到身后传来『哗啦』一声纸张撕裂的声音。"},{character:null,text:"回头一看，汐音正站在杂志区前面。"},{character:null,text:"她手里拿着一本封面花花绿绿的时尚杂志，因为不知道怎么翻页，用力过猛，把封面撕下来了一角。"},{character:null,text:"旁边的店员投来了怀疑的目光。"},{character:"xiyin",text:"啊……坏、坏掉了……",sprite:"./assets/characters/heroine/flustered.png"},{character:"xiyin",text:"我只是……想看看里面的人为什么皮肤那么亮……可是纸太薄了……",sprite:"./assets/characters/heroine/flustered.png"},{character:null,text:"她慌乱地拿着那张碎纸片，手指绞在一起，不知所措地站在原地。"},{character:null,text:"像个做错事的孩子，眼神游移，不敢看我，也不敢看店员。"},{character:null,text:"周围的空气仿佛凝固了。"},{character:null,text:"【关键抉择】",effect:"fade"},{choices:[{text:"（一把夺过杂志，拉着她快步离开）",nextScene:"chapter6_escape",affection:-3,alienation:0,adaptation:-5},{text:"没关系，这本我们买下来。",nextScene:"chapter6_buyMag",affection:5,alienation:0,adaptation:2,money:25},{text:"笨手笨脚的……来，我教你。",nextScene:"chapter6_boundary",affection:-10,alienation:5,adaptation:0}]}]},chapter6_escape:{background:"./assets/backgrounds/convenience_store.png",bgm:"./assets/bgm/store_ambient.mp3",dialogs:[{character:"protagonist",text:"快走！别看了！"},{character:null,text:"我因为不想惹麻烦，一把抓起那本杂志塞回货架深处，拉着她的手腕就往外走。"},{character:null,text:"汐音踉踉跄跄地跟着我，出门后甩开了我的手。"},{character:"xiyin",text:"痛……明明是你带我来的……为什么要逃跑？",sprite:"./assets/characters/heroine/angry.png"},{character:null,text:"【第六章 END - 信任受损】",effect:"fade"}],nextScene:"chapter7"},chapter6_buyMag:{background:"./assets/backgrounds/convenience_store.png",bgm:"./assets/bgm/store_ambient.mp3",dialogs:[{character:"protagonist",text:"别怕。弄坏了买下来就是了。"},{character:null,text:"我从她手中轻轻抽走那本杂志，夹在腋下，语气平静。"},{character:null,text:"汐音惊讶地抬起头，原本紧绷的肩膀松弛了下来。"},{character:"xiyin",text:"诶？可是……它已经破了……",sprite:"./assets/characters/heroine/surprised.png"},{character:"protagonist",text:"破了也能看。而且，比起杂志，你的手没被纸划伤吧？"},{character:null,text:"汐音愣住了。"},{character:null,text:"她看了看自己的手，又看了看我，嘴角微微抿起，露出了安心的神色。"},{character:null,text:"她向我靠近了一点，手指轻轻捏住了我的衣角。"},{character:"xiyin",text:"……没有。谢谢。",sprite:"./assets/characters/heroine/normal.png"},{character:"xiyin",text:"刚才的你……看起来有一点点……帅气。",sprite:"./assets/characters/heroine/shy.png"},{character:null,text:"【第六章 END - 信任加深】",effect:"fade"}],nextScene:"chapter7"},chapter6_boundary:{background:"./assets/backgrounds/convenience_store.png",bgm:"./assets/bgm/store_ambient.mp3",dialogs:[{character:null,text:"看着她笨拙的样子，我叹了口气，走到她身后。"},{character:null,text:"我没有拿走杂志，而是直接伸出手，覆盖在她拿着杂志的手背上。"},{character:null,text:"身体前倾，将她圈在怀里和货架之间。"},{character:"protagonist",text:"别用力，要用指腹……像这样。"},{character:null,text:"我以为这会是一个浪漫的教学时刻，甚至能闻到她发丝的香气。"},{character:null,text:"然而——"},{character:"xiyin",text:"！！！",sprite:"./assets/characters/heroine/alert.png"},{character:null,text:"在我的皮肤触碰到她的瞬间，汐音猛地倒吸一口凉气。"},{character:null,text:"那是生理性的排斥。"},{character:null,text:"她像是一条被鱼网突然缠住的鱼，剧烈地挣扎了一下，猛地向旁边缩去，直接撞到了旁边的零食货架。",effect:"shake"},{character:"xiyin",text:"别碰我！！",sprite:"./assets/characters/heroine/scared.png"},{character:null,text:"她的声音很大，带上了颤音。"},{character:null,text:"她抱着肩膀缩在角落里，用一种看敌人的眼神死死盯着我。"},{character:null,text:"那是恐惧，是对被束缚、被捕获的本能恐惧。"},{character:"xiyin",text:"背后……不要站在背后抓我……",sprite:"./assets/characters/heroine/scared.png"},{character:"xiyin",text:"像……网一样……恶心。",sprite:"./assets/characters/heroine/angry.png"},{character:null,text:"『恶心』。"},{character:null,text:"这两个字像冰锥一样刺进我心里。"},{character:null,text:"周围的顾客和店员都看了过来，窃窃私语。"},{character:null,text:"我举着双手僵在原地，尴尬得想找个地缝钻进去。"},{character:null,text:"我搞砸了。在这个陌生的环境中，过度的亲密只会让她感到威胁。"},{character:"protagonist",text:"抱、抱歉……我只是想教你……"},{character:"xiyin",text:"……离我远点。",sprite:"./assets/characters/heroine/alert.png"},{character:null,text:"接下来的结账过程，她一直离我两米远，再也没有跟我说过一句话。"},{character:null,text:"回家的路上，夕阳把我们的影子拉得很远，中间隔着无法跨越的鸿沟。"},{character:null,text:"【第六章 END - 触发戒备】",effect:"fade"}],nextScene:"chapter7"},chapter7:{background:"./assets/backgrounds/living_room_morning.png",bgm:"./assets/bgm/morning_peace.mp3",dialogs:[{character:null,text:"【第七章：待续...】",effect:"fade"},{character:null,text:"（剧情开发中，敬请期待）"}]}}},j=ie(we((t,s)=>({gameState:"title",currentSceneId:"start",currentDialogIndex:0,characters:{},displayedText:"",isTextComplete:!1,showChoices:!1,currentChoices:[],history:[],unlockedScenes:["start"],affection:10,alienation:50,adaptation:0,money:1e3,flags:{girlfriendDeclared:!1,scalesPraised:!1,tridentFound:!1},saveSlots:Array(10).fill(null),settings:{textSpeed:50,autoPlayDelay:2e3,bgmVolume:.7,seVolume:1},startGame:()=>{t({gameState:"playing",currentSceneId:"start",currentDialogIndex:0,history:[],displayedText:"",isTextComplete:!1,showChoices:!1,affection:10,alienation:50,adaptation:0,money:1e3,flags:{girlfriendDeclared:!1,scalesPraised:!1,tridentFound:!1}})},continueGame:a=>{t({...a,gameState:"playing"})},getCurrentScene:()=>{const{currentSceneId:a}=s();return N.scenes[a]},getCurrentDialog:()=>{const a=s().getCurrentScene();return a?a.dialogs[s().currentDialogIndex]:null},nextDialog:()=>{var u;const{currentSceneId:a,currentDialogIndex:c,history:n}=s(),r=s().getCurrentScene();if(!r)return;const h=r.dialogs[c];if(h&&t({history:[...n,{sceneId:a,dialog:h}]}),h!=null&&h.choices){t({showChoices:!0,currentChoices:h.choices,isTextComplete:!0});return}if(c>=r.dialogs.length-1)if(r.nextScene){const{unlockedScenes:i}=s(),o=i.includes(r.nextScene)?i:[...i,r.nextScene];t({currentSceneId:r.nextScene,currentDialogIndex:0,displayedText:"",isTextComplete:!1,unlockedScenes:o});const w=N.scenes[r.nextScene];(u=w==null?void 0:w.dialogs[0])!=null&&u.choices&&t({showChoices:!0,currentChoices:w.dialogs[0].choices,isTextComplete:!0})}else t({gameState:"ending"});else{const i=c+1,o=r.dialogs[i];t({currentDialogIndex:i,displayedText:"",isTextComplete:!1}),o!=null&&o.choices&&!(o!=null&&o.text)&&t({showChoices:!0,currentChoices:o.choices,isTextComplete:!0})}},selectChoice:a=>{const{history:c,currentSceneId:n,affection:r,alienation:h,adaptation:u,money:i,flags:o,unlockedScenes:w}=s();let l=r+(a.affection||0),d=h+(a.alienation||0),x=u+(a.adaptation||0),v=i-(a.money||0),m={...o};l=Math.max(0,Math.min(100,l)),d=Math.max(0,Math.min(100,d)),x=Math.max(0,Math.min(100,x)),a.flag&&(m[a.flag]=!0);const g=w.includes(a.nextScene)?w:[...w,a.nextScene];t({history:[...c,{sceneId:n,choice:a.text,stats:{affection:a.affection||0,alienation:a.alienation||0,adaptation:a.adaptation||0}}],currentSceneId:a.nextScene,currentDialogIndex:0,showChoices:!1,currentChoices:[],displayedText:"",isTextComplete:!1,affection:l,alienation:d,adaptation:x,money:v,flags:m,unlockedScenes:g})},getStats:()=>{const{affection:a,alienation:c,adaptation:n,flags:r}=s();return{affection:a,alienation:c,adaptation:n,flags:r}},updateStats:a=>{const{affection:c,alienation:n,adaptation:r}=s();t({affection:Math.max(0,Math.min(100,c+(a.affection||0))),alienation:Math.max(0,Math.min(100,n+(a.alienation||0))),adaptation:Math.max(0,Math.min(100,r+(a.adaptation||0)))})},setFlag:(a,c=!0)=>{const{flags:n}=s();t({flags:{...n,[a]:c}})},checkEnding:()=>{const{affection:a,alienation:c,adaptation:n,flags:r}=s();return a<30?"dead":a>=80&&c>=40&&c<=80&&n>=60?"true":c<20&&n>=70?"bad":a>=60&&n<40?"good":null},setDisplayedText:a=>t({displayedText:a}),setTextComplete:a=>t({isTextComplete:a}),saveGame:a=>{var m;const{currentSceneId:c,currentDialogIndex:n,history:r,saveSlots:h,characters:u,affection:i,alienation:o,adaptation:w,money:l,flags:d,unlockedScenes:x}=s(),v=[...h];v[a]={currentSceneId:c,currentDialogIndex:n,history:r,characters:u,unlockedScenes:x,affection:i,alienation:o,adaptation:w,money:l,flags:d,savedAt:new Date().toISOString(),thumbnail:((m=N.scenes[c])==null?void 0:m.background)||null},t({saveSlots:v})},loadGame:a=>{const{saveSlots:c}=s(),n=c[a];n&&t({currentSceneId:n.currentSceneId,currentDialogIndex:n.currentDialogIndex,history:n.history,characters:n.characters,unlockedScenes:n.unlockedScenes??["start"],affection:n.affection??10,alienation:n.alienation??50,adaptation:n.adaptation??0,money:n.money??1e3,flags:n.flags??{girlfriendDeclared:!1,scalesPraised:!1,tridentFound:!1},gameState:"playing",displayedText:"",isTextComplete:!1,showChoices:!1})},returnToTitle:()=>{t({gameState:"title",showChoices:!1})},jumpToScene:a=>{t({currentSceneId:a,currentDialogIndex:0,gameState:"playing",displayedText:"",isTextComplete:!1,showChoices:!1})},updateSettings:a=>{t({settings:{...s().settings,...a}})},setGameState:a=>t({gameState:a})}),{name:"galgame-storage",partialize:t=>({saveSlots:t.saveSlots,settings:t.settings,unlockedScenes:t.unlockedScenes})}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ve={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_=(t,s)=>{const a=y.forwardRef(({color:c="currentColor",size:n=24,strokeWidth:r=2,absoluteStrokeWidth:h,className:u="",children:i,...o},w)=>y.createElement("svg",{ref:w,...ve,width:n,height:n,stroke:c,strokeWidth:h?Number(r)*24/Number(n):r,className:["lucide",`lucide-${ke(t)}`,u].join(" "),...o},[...s.map(([l,d])=>y.createElement(l,d)),...Array.isArray(i)?i:[i]]));return a.displayName=`${t}`,a};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=_("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=_("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=_("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=_("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=_("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=_("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=_("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=_("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=_("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=_("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=_("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=_("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=_("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),R=[{id:"start",title:"序章",subtitle:"潮汐的赠礼",scene:"start",row:0,col:1,children:["chapter1"]},{id:"chapter1",title:"第一章",subtitle:"陆地上的第一口空气",scene:"chapter1",row:1,col:1,children:["chapter2"]},{id:"chapter2",title:"第二章",subtitle:"危险的温度",scene:"chapter2",row:2,col:1,children:["chapter3"]},{id:"chapter3",title:"第三章",subtitle:"干涸的焦虑",scene:"chapter3",row:3,col:1,children:["chapter4"]},{id:"chapter4",title:"第四章",subtitle:"清晨的不速之客",scene:"chapter4",row:4,col:1,children:["chapter5"]},{id:"chapter5",title:"第五章",subtitle:"鳞片下的秘密",scene:"chapter5",row:5,col:1,children:["chapter6"]},{id:"chapter6",title:"第六章",subtitle:"外面的世界",scene:"chapter6",row:6,col:1,children:["chapter7"]},{id:"chapter7",title:"第七章",subtitle:"待续...",scene:"chapter7",row:7,col:1,children:[]}],C=100,T=50,W=70,q=120;function z({onClose:t}){const{unlockedScenes:s,jumpToScene:a}=j(),c=y.useRef(null),n=l=>(s==null?void 0:s.includes(l.scene))||l.scene==="start",r=l=>{n(l)&&(a(l.scene),t())},h=l=>{const d=50+(l.col-1)*q,x=20+l.row*W;return{x:d,y:x}},i=40+(Math.max(...R.map(l=>l.row))+1)*W,o=()=>R.map(l=>{const d=h(l);return l.children.map(x=>{const v=R.find(ce=>ce.id===x);if(!v)return null;const m=h(v),g=n(l),f=n(v),p=g&&f,k=d.x+C/2,D=d.y+T,P=m.x+C/2,G=m.y,F=(D+G)/2;return e.jsx("path",{d:`M ${k} ${D} C ${k} ${F}, ${P} ${F}, ${P} ${G}`,stroke:p?"#22d3ee":"#374151",strokeWidth:"2",fill:"none",opacity:p?1:.3},`${l.id}-${x}`)})}),w=()=>R.map(l=>{const d=h(l),x=n(l);return e.jsxs(b.g,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:l.row*.05},children:[e.jsx("rect",{x:d.x,y:d.y,width:C,height:T,rx:"8",fill:x?"url(#nodeGradient)":"#1f2937",stroke:x?"#22d3ee":"#374151",strokeWidth:"2",className:x?"cursor-pointer":"cursor-not-allowed",onClick:()=>r(l)}),e.jsx("text",{x:d.x+C/2,y:d.y+T/2-6,textAnchor:"middle",fill:x?"#ffffff":"#6b7280",fontSize:"11",fontWeight:"bold",className:"pointer-events-none select-none",children:x?l.title:"???"}),e.jsx("text",{x:d.x+C/2,y:d.y+T/2+10,textAnchor:"middle",fill:x?"#94a3b8":"#4b5563",fontSize:"9",className:"pointer-events-none select-none",children:x&&l.subtitle||""}),!x&&e.jsx("g",{transform:`translate(${d.x+C/2-6}, ${d.y+T/2-6})`,children:e.jsx(_e,{size:12,className:"text-gray-500"})})]},l.id)});return e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:t,children:e.jsxs(b.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-4xl mx-4 h-[85vh] bg-gradient-to-b from-gray-900/95 to-black/95 rounded-2xl border border-white/10 overflow-hidden flex flex-col",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"剧情回顾"}),e.jsx("p",{className:"text-white/50 text-xs mt-1",children:"点击已解锁章节可重新体验"})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(O,{className:"w-6 h-6 text-white/70"})})]}),e.jsx("div",{ref:c,className:"flex-1 overflow-auto p-4",children:e.jsxs("svg",{width:"100%",height:i,viewBox:`0 0 ${50+3*q} ${i}`,preserveAspectRatio:"xMidYMin meet",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"nodeGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#164e63"}),e.jsx("stop",{offset:"100%",stopColor:"#0c4a6e"})]})}),o(),w()]})}),e.jsxs("div",{className:"p-3 border-t border-white/10 flex justify-center gap-6 text-xs shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-b from-cyan-800 to-cyan-900 border border-cyan-400"}),e.jsx("span",{className:"text-white/60",children:"已解锁"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-800 border border-gray-600"}),e.jsx("span",{className:"text-white/60",children:"未解锁"})]})]})]})})}function ae({onClose:t}){const{settings:s,updateSettings:a,returnToTitle:c,saveGame:n,gameState:r}=j(),h=l=>{a({bgmVolume:parseFloat(l.target.value)})},u=l=>{a({textSpeed:parseInt(l.target.value)})},i=()=>{n(0),t(),c()},o=()=>{t(),c()},w=r==="playing";return e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:t,children:e.jsxs(b.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-md mx-4 bg-gradient-to-b from-gray-900/95 to-black/95 rounded-2xl border border-white/10 overflow-hidden",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"游戏设置"}),e.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(O,{className:"w-6 h-6 text-white/70"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/80",children:[e.jsx(Te,{className:"w-5 h-5"}),e.jsx("span",{children:"游戏音量"}),e.jsxs("span",{className:"ml-auto text-cyan-400",children:[Math.round(s.bgmVolume*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:s.bgmVolume,onChange:h,className:`w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer
                [&::-webkit-slider-thumb]:appearance-none
                [&::-webkit-slider-thumb]:w-4
                [&::-webkit-slider-thumb]:h-4
                [&::-webkit-slider-thumb]:rounded-full
                [&::-webkit-slider-thumb]:bg-cyan-400
                [&::-webkit-slider-thumb]:cursor-pointer
                [&::-webkit-slider-thumb]:shadow-lg
                [&::-webkit-slider-thumb]:shadow-cyan-400/30
              `})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white/80",children:[e.jsx(Ce,{className:"w-5 h-5"}),e.jsx("span",{children:"字幕显示速度"}),e.jsx("span",{className:"ml-auto text-cyan-400",children:s.textSpeed<=20?"快":s.textSpeed<=50?"中":"慢"})]}),e.jsx("input",{type:"range",min:"10",max:"100",step:"10",value:s.textSpeed,onChange:u,className:`w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer
                [&::-webkit-slider-thumb]:appearance-none
                [&::-webkit-slider-thumb]:w-4
                [&::-webkit-slider-thumb]:h-4
                [&::-webkit-slider-thumb]:rounded-full
                [&::-webkit-slider-thumb]:bg-cyan-400
                [&::-webkit-slider-thumb]:cursor-pointer
                [&::-webkit-slider-thumb]:shadow-lg
                [&::-webkit-slider-thumb]:shadow-cyan-400/30
              `}),e.jsxs("div",{className:"flex justify-between text-xs text-white/40",children:[e.jsx("span",{children:"快"}),e.jsx("span",{children:"慢"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-white/10 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:t,className:"flex-1 py-3 px-4 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors",children:"关闭"}),w&&e.jsxs("button",{onClick:i,className:"flex-1 py-3 px-4 bg-cyan-500/20 hover:bg-cyan-500/40 text-cyan-300 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"保存并返回"]})]}),e.jsxs("button",{onClick:o,className:"w-full py-3 px-6 bg-red-500/20 hover:bg-red-500/40 text-red-300 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"不保存，返回主菜单"]})]})]})})}const M=new Map,I=new Map,$=t=>{if(!t)return Promise.resolve(null);if(M.has(t))return Promise.resolve(M.get(t));if(I.has(t))return I.get(t);const s=new Promise((a,c)=>{const n=new Image;n.onload=()=>{M.set(t,n),I.delete(t),a(n)},n.onerror=()=>{I.delete(t),c(new Error(`Failed to load: ${t}`))},n.src=t});return I.set(t,s),s},Ie=async t=>{const s=t.filter(Boolean).map($);return Promise.allSettled(s)},re=t=>M.has(t),Y=t=>{if(!t)return[];const s=[];return t.background&&s.push(t.background),t.dialogs&&t.dialogs.forEach(a=>{a.sprite&&s.push(a.sprite)}),[...new Set(s)]},ne=async(t,s,a)=>{const c=[];return c.push(...Y(t)),s&&a[s]&&c.push(...Y(a[s])),t!=null&&t.dialogs&&t.dialogs.forEach(n=>{n.choices&&n.choices.forEach(r=>{if(r.nextScene&&a[r.nextScene]){const h=a[r.nextScene];h.background&&c.push(h.background)}})}),Ie([...new Set(c)])},J="./assets/menu/main_menu.png";function V({isEnding:t=!1}){const{startGame:s,setGameState:a,saveSlots:c,settings:n}=j(),r=y.useRef(null),[h,u]=y.useState(!1),[i,o]=y.useState(!1),[w,l]=y.useState(!1),[d,x]=y.useState(!1);y.useEffect(()=>{$(J).then(()=>x(!0));const f=N.scenes.start;f&&ne(f,f.nextScene,N.scenes)},[]),y.useEffect(()=>{r.current&&(r.current.volume=n.bgmVolume)},[n.bgmVolume]);const v=()=>{r.current&&!w&&r.current.play().then(()=>{l(!0)}).catch(()=>{})};y.useEffect(()=>()=>{r.current&&r.current.pause()},[]);const m=c.some(f=>f!==null),g=[{icon:ee,label:t?"重新开始":"开始游戏",action:s},...m?[{icon:je,label:"继续游戏",action:()=>a("menu")}]:[],{icon:Se,label:"剧情回顾",action:()=>u(!0),disabled:!1},{icon:te,label:"游戏设置",action:()=>o(!0),disabled:!1}];return e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.8},className:"w-full h-full flex flex-col items-center justify-end md:justify-center relative overflow-hidden",onClick:v,children:[e.jsx(b.div,{className:"absolute inset-0",initial:{opacity:0,scale:1.05},animate:{opacity:d?1:0,scale:[1,1.02,1]},transition:{opacity:{duration:.8},scale:{duration:8,repeat:1/0,ease:"easeInOut"}},children:e.jsx("div",{className:"w-full h-full bg-cover bg-center md:bg-center bg-no-repeat",style:{backgroundImage:`url(${J})`,backgroundPosition:"center 20%"}})}),!d&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-slate-900 to-slate-800 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-2 border-cyan-400/30 border-t-cyan-400 rounded-full animate-spin"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"}),e.jsx(b.div,{className:"absolute inset-0 overflow-hidden pointer-events-none",initial:{opacity:0},animate:{opacity:d?1:0},children:[...Array(6)].map((f,p)=>e.jsx(b.div,{className:"absolute text-pink-300/20",style:{left:`${15+p*15}%`,bottom:"-20px",fontSize:`${14+p%3*4}px`},animate:{y:[0,-window.innerHeight-50],opacity:[0,.4,.3,0],x:[0,p%2===0?15:-15,0]},transition:{duration:8+p*2,repeat:1/0,delay:p*1.5,ease:"easeOut"},children:"♥"},p))}),e.jsxs(b.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:d?1:0},transition:{delay:.3,duration:.8},className:"relative z-10 text-center mb-6 md:mb-16 md:absolute md:top-[12%]",children:[e.jsx(b.h1,{className:"text-4xl sm:text-5xl md:text-7xl font-serif font-bold mb-2 md:mb-4 tracking-widest",style:{background:"linear-gradient(180deg, #ffffff 0%, #e0f2fe 40%, #7dd3fc 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",textShadow:"none",filter:"drop-shadow(0 2px 8px rgba(125, 211, 252, 0.4))"},animate:{filter:["drop-shadow(0 2px 8px rgba(125, 211, 252, 0.3))","drop-shadow(0 2px 16px rgba(125, 211, 252, 0.5))","drop-shadow(0 2px 8px rgba(125, 211, 252, 0.3))"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:t?"THE END":N.title}),e.jsx("p",{className:"text-base md:text-xl font-light tracking-[0.3em]",style:{color:"rgba(186, 230, 253, 0.8)",textShadow:"0 1px 4px rgba(0, 0, 0, 0.5)"},children:t?"感谢游玩":N.subtitle})]}),e.jsx(b.div,{initial:{y:30,opacity:0},animate:{y:0,opacity:d?1:0},transition:{delay:.5,duration:.8},className:"relative z-10 flex flex-col gap-2 md:gap-3 pb-20 md:pb-0 md:absolute md:bottom-[15%] w-full px-6 md:px-0 md:w-auto",children:g.map((f,p)=>e.jsxs(b.button,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.6+p*.08},onClick:f.action,disabled:f.disabled,whileHover:{scale:1.02,x:5},whileTap:{scale:.98},className:`
              group flex items-center gap-3 md:gap-4 px-5 md:px-8 py-3 md:py-4 
              bg-black/30 hover:bg-black/50 
              border border-white/20 hover:border-cyan-400/50
              rounded-xl backdrop-blur-md
              transition-all duration-300 ease-out
              ${f.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer"}
            `,children:[e.jsx(f.icon,{className:"w-5 h-5 md:w-6 md:h-6 text-cyan-300/80 group-hover:text-cyan-300 transition-colors"}),e.jsx("span",{className:"text-base md:text-lg text-white/90 group-hover:text-white font-medium tracking-wide transition-colors",children:f.label})]},f.label))}),e.jsx(b.div,{initial:{opacity:0},animate:{opacity:d?1:0},transition:{delay:1},className:"absolute bottom-4 md:bottom-6 text-white/40 text-xs md:text-sm z-10",children:"Made with @Starry | 蔚蓝回响 Azure Echoes"}),e.jsx("audio",{ref:r,src:"./assets/bgm/menu.mp3",loop:!0,preload:"auto"}),e.jsx(S,{children:h&&e.jsx(z,{onClose:()=>u(!1)})}),e.jsx(S,{children:i&&e.jsx(ae,{onClose:()=>o(!1)})})]})}function Ee({dialog:t}){const{settings:s,isTextComplete:a,setDisplayedText:c,setTextComplete:n,displayedText:r}=j(),[h,u]=y.useState(""),i=y.useRef(null),o=t!=null&&t.character?N.characters[t.character]:null;return y.useEffect(()=>{if(!(t!=null&&t.text))return;if(i.current&&clearTimeout(i.current),a){u(t.text),c(t.text);return}u(""),c("");let l=0;const d=t.text,x=()=>{l<d.length?(u(d.slice(0,l+1)),c(d.slice(0,l+1)),l++,i.current=setTimeout(x,s.textSpeed)):n(!0)};return i.current=setTimeout(x,s.textSpeed),()=>{i.current&&clearTimeout(i.current)}},[t==null?void 0:t.text,a,s.textSpeed]),y.useEffect(()=>{a&&(t!=null&&t.text)&&u(t.text)},[a,t==null?void 0:t.text]),!t||t.choices?null:e.jsx(b.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},className:"absolute bottom-0 left-0 right-0 p-2 md:p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"relative h-[140px] md:h-[160px] bg-gradient-to-b from-black/70 to-black/85 md:from-black/80 md:to-black/90 backdrop-blur-md rounded-xl border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-pink-500/50 to-transparent"}),e.jsxs("div",{className:"p-3 md:p-4 h-full flex flex-col",children:[e.jsx(S,{mode:"wait",children:o&&e.jsx(b.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},exit:{x:20,opacity:0},className:"mb-2 shrink-0",children:e.jsx("span",{className:"text-sm md:text-base font-bold tracking-wider px-3 py-0.5 rounded-full",style:{color:o.color,backgroundColor:`${o.color}20`},children:o.name})},o.name)}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("p",{className:"text-white text-sm md:text-lg leading-relaxed tracking-wide font-serif",children:[h,!a&&e.jsx("span",{className:"inline-block w-0.5 h-4 bg-white/70 ml-1 animate-pulse"})]})}),e.jsx(S,{children:a&&!t.choices&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex justify-end mt-2",children:e.jsx(b.div,{animate:{y:[0,5,0]},transition:{repeat:1/0,duration:1.5},className:"text-white/50",children:"▼"})})})]})]})})})}function De(){const{currentChoices:t,selectChoice:s}=j();return e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"absolute inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm px-4",onClick:a=>a.stopPropagation(),onTouchEnd:a=>a.stopPropagation(),children:e.jsx(b.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{duration:.15},className:"flex flex-col gap-3 md:gap-4 p-4 md:p-8 w-full max-w-2xl",children:t.map((a,c)=>e.jsxs(b.button,{initial:{x:-30,opacity:0},animate:{x:0,opacity:1},transition:{delay:c*.05,duration:.15},onClick:()=>s(a),className:`
              group relative px-8 md:px-12 py-4 md:py-5 
              bg-gradient-to-r from-white/10 to-white/5
              active:from-pink-500/30 active:to-purple-500/30
              border border-white/20 active:border-pink-400/50
              rounded-lg backdrop-blur-md
              transition-all duration-150 ease-out
              overflow-hidden touch-manipulation
            `,children:[e.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-pink-500/10 to-purple-500/10"}),e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-pink-500/20 to-purple-500/20 blur-xl"})]}),e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-white/30 text-sm font-mono",children:String(c+1).padStart(2,"0")}),e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("span",{className:"text-white text-base md:text-lg tracking-wide font-medium",children:a.text}),a.money&&e.jsxs("span",{className:"text-yellow-400/80 text-xs mt-1",children:["💰 -¥",a.money]})]}),e.jsx(b.span,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-white/30 group-hover:text-white/70",animate:{x:[0,5,0]},transition:{repeat:1/0,duration:1.5},children:"→"})]},c))})})}function Pe({dialog:t,sceneId:s}){const[a,c]=y.useState(null),[n,r]=y.useState("center"),[h,u]=y.useState(!1);if(y.useEffect(()=>{c(null),r("center"),u(!1)},[s]),y.useEffect(()=>{t!=null&&t.sprite&&(re(t.sprite)?(c(t.sprite),r(t.position||"center"),u(!0)):(u(!1),$(t.sprite).then(()=>{c(t.sprite),r(t.position||"center"),u(!0)})))},[t==null?void 0:t.sprite,t==null?void 0:t.position]),!a)return null;const i=()=>{switch(n){case"left":return"left-[10%]";case"right":return"right-[10%]";case"center":default:return"left-1/2 -translate-x-1/2"}};return e.jsx(S,{mode:"wait",children:e.jsx(b.div,{initial:{opacity:0,y:30},animate:{opacity:h?1:0,y:h?0:30},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeOut"},className:`absolute ${i()} pointer-events-none`,style:{bottom:"calc(156px)"},children:e.jsx("img",{src:a,alt:"Character",className:"max-h-[calc(100vh-200px)] md:max-h-[calc(100vh-240px)] w-auto object-contain drop-shadow-2xl",loading:"lazy",decoding:"async",onError:o=>{o.target.style.display="none"}})},a)})}function Re(){const{setGameState:t,nextDialog:s,isTextComplete:a,showChoices:c,getCurrentDialog:n}=j(),[r,h]=y.useState(!1),[u,i]=y.useState(!1),[o,w]=y.useState(!1),l=y.useRef(null);y.useEffect(()=>{var x;if(l.current&&(clearTimeout(l.current),l.current=null),o&&a&&!c){const v=n(),m=((x=v==null?void 0:v.text)==null?void 0:x.length)||0,g=Math.min(3e3,Math.max(800,500+m*50));l.current=setTimeout(()=>{s()},g)}return()=>{l.current&&clearTimeout(l.current)}},[o,a,c,s,n]);const d=[{icon:Ne,label:"菜单",action:()=>t("menu"),active:!1},{icon:L,label:"存档",action:()=>t("menu"),active:!1},{icon:Z,label:"剧情回顾",action:()=>h(!0),active:!1},{icon:ee,label:o?"停止自动":"自动",action:()=>w(!o),active:o},{icon:te,label:"设置",action:()=>i(!0),active:!1}];return e.jsxs(e.Fragment,{children:[e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute top-3 right-3 md:top-4 md:right-4 z-20",onClick:x=>x.stopPropagation(),onTouchEnd:x=>x.stopPropagation(),children:e.jsx("div",{className:"flex gap-1.5 md:gap-2",children:d.map(x=>e.jsx(b.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:x.action,className:`
                p-2.5 md:p-3 rounded-lg
                backdrop-blur-sm
                border transition-all duration-200
                group touch-manipulation
                ${x.active?"bg-cyan-500/30 border-cyan-400/50 active:bg-cyan-500/50":"bg-black/40 active:bg-black/60 border-white/10 active:border-white/30"}
              `,title:x.label,children:e.jsx(x.icon,{className:`w-4 h-4 md:w-5 md:h-5 transition-colors ${x.active?"text-cyan-300":"text-white/70"}`})},x.label))})}),e.jsx(S,{children:r&&e.jsx(z,{onClose:()=>h(!1)})}),e.jsx(S,{children:u&&e.jsx(ae,{onClose:()=>i(!1)})})]})}const Me=()=>{const t=j(c=>c.affection),s=j(c=>c.money),a=()=>t>=80?"text-pink-400":t>=60?"text-rose-400":t>=40?"text-red-400":t>=20?"text-orange-400":"text-gray-400";return e.jsxs(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:`fixed top-4 left-4 z-40 flex flex-col gap-1
                 bg-black/40 backdrop-blur-sm rounded-lg px-3 py-2
                 border border-white/10`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"w-4 h-4 text-gray-600",strokeWidth:2}),e.jsx("div",{className:"absolute inset-0 overflow-hidden",style:{clipPath:`inset(${100-t}% 0 0 0)`},children:e.jsx(U,{className:`w-4 h-4 ${a()}`,fill:"currentColor",strokeWidth:2})})]}),e.jsx("span",{className:`text-sm font-medium ${a()}`,children:t})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-yellow-400 text-sm",children:"💰"}),e.jsxs("span",{className:"text-sm font-medium text-yellow-300",children:["¥",s.toLocaleString()]})]})]})};function Ae(){const{getCurrentScene:t,getCurrentDialog:s,nextDialog:a,isTextComplete:c,showChoices:n,currentSceneId:r}=j(),[h,u]=y.useState(!1),i=t(),o=s();y.useEffect(()=>{i&&(i.background&&re(i.background)?u(!0):u(!1),ne(i,i.nextScene,N.scenes).then(()=>{i.background&&$(i.background).then(()=>u(!0))}))},[i,r]);const w=y.useCallback(()=>{n||(c?a():j.setState({isTextComplete:!0}))},[c,n,a]);return y.useEffect(()=>{const l=d=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),w()),d.key==="Escape"&&j.getState().setGameState("menu")};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[w]),i?e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full h-full relative overflow-hidden cursor-pointer",onClick:w,children:[e.jsx(S,{mode:"wait",children:e.jsx(b.div,{initial:{opacity:0},animate:{opacity:h?1:0},exit:{opacity:0},transition:{duration:.5},className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:i.background?`url(${i.background})`:"linear-gradient(135deg, #2d1b4e 0%, #1a1a2e 100%)"},children:e.jsx("div",{className:"absolute inset-0 bg-black/20"})},i.background)}),e.jsx(S,{children:!h&&i.background&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 flex items-center justify-center bg-gradient-to-b from-slate-900 to-slate-800",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-cyan-400/30 border-t-cyan-400 rounded-full animate-spin"}),e.jsx("span",{className:"text-cyan-400/70 text-sm",children:"Loading..."})]})})}),e.jsx(Pe,{dialog:o,sceneId:r}),e.jsx(Me,{}),e.jsx(Re,{}),e.jsx(Ee,{dialog:o}),e.jsx(S,{children:n&&e.jsx(De,{})}),e.jsx(S,{children:(o==null?void 0:o.effect)==="flash"&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:.5},className:"absolute inset-0 bg-white pointer-events-none"})})]}):null}function $e(){const{setGameState:t,returnToTitle:s,saveGame:a,loadGame:c,saveSlots:n}=j(),[r,h]=y.useState(!1),u=()=>t("playing");return e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",onClick:u,children:[e.jsxs(b.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"w-full max-w-2xl mx-4 bg-gradient-to-b from-gray-900/95 to-black/95 rounded-2xl border border-white/10 overflow-hidden",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-white/10",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"游戏菜单"}),e.jsx("button",{onClick:u,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",children:e.jsx(O,{className:"w-6 h-6 text-white/70"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-white/80 mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"存档 / 读档"]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-64 overflow-y-auto",children:n.map((i,o)=>e.jsxs("div",{className:`
                  group relative p-4 rounded-lg
                  bg-white/5 hover:bg-white/10
                  border border-white/10 hover:border-white/20
                  transition-all duration-200
                `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-white/60 text-sm",children:["存档 ",o+1]}),i&&e.jsx("span",{className:"text-white/40 text-xs",children:new Date(i.savedAt).toLocaleDateString("zh-CN")})]}),i?e.jsxs("p",{className:"text-white/80 text-sm truncate mb-3",children:["场景: ",i.currentSceneId]}):e.jsx("p",{className:"text-white/40 text-sm mb-3",children:"空"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>a(o),className:"flex-1 py-1.5 px-3 text-xs bg-blue-500/20 hover:bg-blue-500/40 text-blue-300 rounded transition-colors",children:"保存"}),i&&e.jsx("button",{onClick:()=>c(o),className:"flex-1 py-1.5 px-3 text-xs bg-green-500/20 hover:bg-green-500/40 text-green-300 rounded transition-colors",children:"读取"})]})]},o))})]}),e.jsxs("div",{className:"p-6 border-t border-white/10 flex flex-wrap gap-4",children:[e.jsxs("button",{onClick:()=>h(!0),className:"flex-1 py-3 px-4 bg-cyan-500/20 hover:bg-cyan-500/40 text-cyan-300 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5"}),"剧情回顾"]}),e.jsx("button",{onClick:u,className:"flex-1 py-3 px-4 bg-white/10 hover:bg-white/20 text-white rounded-lg transition-colors flex items-center justify-center gap-2",children:"继续游戏"}),e.jsxs("button",{onClick:s,className:"py-3 px-6 bg-red-500/20 hover:bg-red-500/40 text-red-300 rounded-lg transition-colors flex items-center justify-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5"}),"返回标题"]})]})]}),e.jsx(S,{children:r&&e.jsx(z,{onClose:()=>h(!1)})})]})}function He(){const{gameState:t}=j();return e.jsxs("div",{className:"w-full h-full bg-black",children:[e.jsxs(S,{mode:"wait",children:[t==="title"&&e.jsx(V,{},"title"),(t==="playing"||t==="menu")&&e.jsx(Ae,{},"game"),t==="ending"&&e.jsx(V,{isEnding:!0},"ending")]}),t==="menu"&&e.jsx($e,{})]})}H.createRoot(document.getElementById("root")).render(e.jsx(oe.StrictMode,{children:e.jsx(He,{})}));
